<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Riddle Archive</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
</head>
<body>
  <header>
    <h1>📚 Riddle Archive</h1>
    <div class="nav-buttons">
      <a href="index.html">🏠 Home</a>
      <a href="create.html" target="_blank">✏️ Create</a>
    </div>
    <button id="theme-toggle">🌙</button>
    <div class="archive-controls">
      <input type="text" id="search" placeholder="Search riddles..." />
      <select id="sort">
        <option value="newest">Newest First</option>
        <option value="oldest">Oldest First</option>
      </select>
    </div>
  </header>

  <main>
    <ul id="archive-list"></ul>
  </main>

  <footer>
    <p>FUN Studios • Archive of Curiosity</p>
  </footer>

  <script>
    const archive = JSON.parse(localStorage.getItem("riddleArchive")) || [];
    const list = document.getElementById("archive-list");
    const searchInput = document.getElementById("search");
    const sortSelect = document.getElementById("sort");

    function renderArchive() {
      list.innerHTML = "";

      let filtered = archive.filter(r =>
        r.question.toLowerCase().includes(searchInput.value.toLowerCase())
      );

      if (sortSelect.value === "newest") {
        filtered = filtered.slice().reverse();
      }

      filtered.forEach((r, i) => {
        const li = document.createElement("li");
        li.className = "riddle-card";
        li.innerHTML = `
          <strong>${r.date}</strong><br>
          <p>${r.question}</p>
          <button onclick="toggleAnswer('a${i}')">Show Answer</button>
          <span id="a${i}" style="display:none;">${r.answer}</span>
        `;
        list.appendChild(li);
      });
    }

    function toggleAnswer(id) {
      const el = document.getElementById(id);
      el.style.display = el.style.display === "none" ? "inline" : "none";
    }

    searchInput.addEventListener("input", renderArchive);
    sortSelect.addEventListener("change", renderArchive);
    renderArchive();

    // Theme toggle
    const toggleBtn = document.getElementById("theme-toggle");
    const body = document.body;

    function applyTheme(theme) {
      body.classList.toggle("dark", theme === "dark");
      toggleBtn.textContent = theme === "dark" ? "🌞" : "🌙";
      localStorage.setItem("theme", theme);
    }

    toggleBtn.addEventListener("click", () => {
      const newTheme = body.classList.contains("dark") ? "light" : "dark";
      applyTheme(newTheme);
    });

    window.addEventListener("load", () => {
      const savedTheme = localStorage.getItem("theme");
      if (savedTheme) {
        applyTheme(savedTheme);
      } else {
        const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        applyTheme(prefersDark ? "dark" : "light");
      }
    });
  </script>
</body>
</html>
