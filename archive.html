<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Riddle Archive</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
</head>
<body>
  <header>
    <h1>📚 Riddle Archive</h1>
    <nav>
      <a href="index.html">🏠 Home</a>
      <a href="create.html" target="_blank">✏️ Create</a>
    </nav>
    <input type="text" id="search" placeholder="Search riddles..." />
    <select id="sort">
      <option value="newest">Newest First</option>
      <option value="oldest">Oldest First</option>
    </select>
  </header>

  <main>
    <ul id="archive-list"></ul>
  </main>

  <footer>
    <p>FUN Studios • Archive of Curiosity</p>
  </footer>

  <script>
    const archive = JSON.parse(localStorage.getItem("riddleArchive")) || [];
    const list = document.getElementById("archive-list");
    const searchInput = document.getElementById("search");
    const sortSelect = document.getElementById("sort");

    function renderArchive() {
      list.innerHTML = "";
      let filtered = archive.filter(r =>
        r.question.toLowerCase().includes(searchInput.value.toLowerCase())
      );

      if (sortSelect.value === "newest") {
        filtered = filtered.slice().reverse();
      }

      filtered.forEach((r, i) => {
        const li = document.createElement("li");
        li.innerHTML = `
          <strong>${r.date}</strong><br>
          ${r.question}<br>
          <button onclick="toggleAnswer('a${i}')">Show Answer</button>
          <span id="a${i}" style="display:none;">${r.answer}</span>
          <hr>
        `;
        list.appendChild(li);
      });
    }

    function toggleAnswer(id) {
      const el = document.getElementById(id);
      el.style.display = el.style.display === "none" ? "inline" : "none";
    }

    searchInput.addEventListener("input", renderArchive);
    sortSelect.addEventListener("change", renderArchive);
    renderArchive();
  </script>
</body>
</html>